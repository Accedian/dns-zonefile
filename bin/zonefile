#!/usr/bin/env node

(function () {
    var fs = require('fs');
    var zonefile = require('../lib/zonefile.js');

    var args = function () {
        var ret = [];
        process.argv.forEach(function (val, index, array) {
            if (index >= 2) {
                ret.push(val);
            }
        });
        if (ret.length === 0) {
            ret.push(__dirname + '/../test/zonefile_forward.json');
            ret.push(__dirname + '/../test/zonefile_reverse.json');
            ret.push(__dirname + '/../test/zonefile_forward.txt');
            ret.push(__dirname + '/../test/zonefile_reverse.txt');
        }
        return ret;
    };

    var input = args();

    for (var i in input) {
        var src = input[i];
        var options = fs.readFileSync(src, 'utf8');
        if (src.toLocaleLowerCase().indexOf('.json') > 0) {
            var output = zonefile.generate(JSON.parse(options));
        } else {
            output = zonefile.parse(options);
        }
        console.log(output);
    }
})();